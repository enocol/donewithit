{% extends "base.html" %}
{% block content %}
<div class="container py-4">
  <h2 class="h4 mb-3">Inbox</h2>

  {% if threads %}
    <div class="list-group">
   {% for t in threads %}
  {% with latest=t.inbound_messages|first %}
    {% if latest %}
      <div class="thread">
        <strong>{{ latest.sender }}</strong>
        <span>{{ latest.created_at }}</span>
        <p>{{ latest.body|truncatechars:120 }}</p>
        {% if unread_counts.t.id %}<span class="badge">{{ unread_counts.t.id }}</span>{% endif %}
      </div>
    {% endif %}
  {% endwith %}
{% endfor %}

    </div>
  {% else %}
    <p class="text-muted">No messages yet.</p>
  {% endif %}
</div>
{% endblock %}

