{% extends 'base.html' %} {% load static %} {% block content %}
<div>
  <div class="container-fluid category-wrapper z-1">
    <button class="scroll-btn left" onclick="scrollCategories(-200)">
      &#8249;
    </button>
    <div class="category-container">
      <a href="{% url 'product_list' %}"
        ><div class="category">All Products</div></a
      >
      {% for c in categories %}
      <a href="{% url 'product_list' %}?category={{ c.name }}" class=""
        ><div class="category">{{ c.get_display_name }}</div></a
      >
      {% endfor %}
    </div>
    <button class="scroll-btn right" onclick="scrollCategories(200)">
      &#8250;
    </button>
  </div>
</div>

<div class="container">

<div class="sorting-wrapper">
  <div>
      <i class="fa-solid fa-list"></i>
      <span>{{ products|length }} Products Found</span>
  </div>
  <div class="sorting">
    <p class="m-0">Sort products:</p>
    <div class="dropdown">
            <button class="btn btn-outline-secondary w-100 dropdown-toggle" type="button" data-bs-toggle="dropdown">
              {% if request.GET.sort %}
                {% for value, label in sort_options %}
                  {% if request.GET.sort == value %} {{ label }} {% endif %}
                {% endfor %}
              {% else %}
                -- Select --
              {% endif %}
            </button>
        <ul class="dropdown-menu">
            {% for value, label in sort_options %}
              <li>
                <a class="dropdown-item {% if request.GET.sort == value %}active{% endif %}"
                  href="?{% for key,val in request.GET.items %}{% if key != 'sort' and key != 'page' %}{{ key }}={{ val|urlencode }}&{% endif %}{% endfor %}sort={{ value }}">
                  {{ label }}
                </a>
              </li>
            {% endfor %}
        </ul>
   </div>
  </div>
</div>

<hr>

<div class="row mb-4">
      {% if messages %}
      <div class="col-md-12">
        {% for message in messages %}
        <div
          class="alert alert-warning alert-dismissible fade show"
          role="alert"
        >
          {{ message }}
          <button
            type="button"
            class="btn-close"
            data-bs-dismiss="alert"
            aria-label="Close"
          ></button>
        </div>
        {% endfor %}
      </div>
      {% endif %}
</div>

    <div class="row">
      {% for product in products %}
      <div class="col-6 col-sm-6 col-md-4 col-lg-3 col-xl-2 mb-4">
        <a href="{% url 'product_detail' product.id %}">
          <div class="card border-0 shadow-sm">
            <img
              src="{{ product.main_image.url }}"
              style="height: 150px; width: 100%; object-fit: contain"
              class="card-img-top"
              alt="{{ product.product_name }}"
            />
            <div class="product-card-body  p-2">
              <h5 class="fs-6 uppercase gray-text">
                {{ product.product_name }}
              </h5>
              <p class="black-text fw-bold mb-0">Â£{{ product.price }}</p>
              <p class="text-muted fs-7 gray-text mb-0">
                <span>Author: </span>{{ product.seller }}
              </p>
              <p class="fs-7 gray-text mb-0">
                <span>Listed: </span>{{ product.created_at|timesince }} ago
              </p>
            </div>
          </div>
        </a>
      </div>
      {% endfor %}
    </div>
  </div>
</div>
{% endblock %}
